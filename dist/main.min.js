!function t(e,n,r){function i(a,u){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!u&&l)return l(a,!0);if(s)return s(a,!0);var o=new Error("Cannot find module '"+a+"'");throw o.code="MODULE_NOT_FOUND",o}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return i(n||t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var s="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){(function(){function t(t){function e(e,n,r,i,s,a){for(;s>=0&&s<a;s+=t){var u=i?i[s]:s;r=n(r,e[u],u,e)}return r}return function(n,r,i,s){r=w(r,s,4);var a=!k(n)&&_.keys(n),u=(a||n).length,l=t>0?0:u-1;return arguments.length<3&&(i=n[a?a[l]:l],l+=t),e(n,r,i,a,l,u)}}function r(t){return function(e,n,r){n=A(n,r);for(var i=j(e),s=t>0?0:i-1;s>=0&&s<i;s+=t)if(n(e[s],s,e))return s;return-1}}function i(t,e,n){return function(r,i,s){var a=0,u=j(r);if("number"==typeof s)t>0?a=s>=0?s:Math.max(s+u,a):u=s>=0?Math.min(s+1,u):s+u+1;else if(n&&s&&u)return s=n(r,i),r[s]===i?s:-1;if(i!==i)return(s=e(h.call(r,a,u),_.isNaN))>=0?s+a:-1;for(s=t>0?a:u-1;s>=0&&s<u;s+=t)if(r[s]===i)return s;return-1}}function s(t,e){var n=B.length,r=t.constructor,i=_.isFunction(r)&&r.prototype||o,s="constructor";for(_.has(t,s)&&!_.contains(e,s)&&e.push(s);n--;)(s=B[n])in t&&t[s]!==i[s]&&!_.contains(e,s)&&e.push(s)}var a=this,u=a._,l=Array.prototype,o=Object.prototype,c=Function.prototype,f=l.push,h=l.slice,p=o.toString,d=o.hasOwnProperty,y=Array.isArray,g=Object.keys,m=c.bind,v=Object.create,b=function(){},_=function(t){return t instanceof _?t:this instanceof _?void(this._wrapped=t):new _(t)};void 0!==n?(void 0!==e&&e.exports&&(n=e.exports=_),n._=_):a._=_,_.VERSION="1.8.3";var w=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,s){return t.call(e,n,r,i,s)}}return function(){return t.apply(e,arguments)}},A=function(t,e,n){return null==t?_.identity:_.isFunction(t)?w(t,e,n):_.isObject(t)?_.matcher(t):_.property(t)};_.iteratee=function(t,e){return A(t,e,1/0)};var S=function(t,e){return function(n){var r=arguments.length;if(r<2||null==n)return n;for(var i=1;i<r;i++)for(var s=arguments[i],a=t(s),u=a.length,l=0;l<u;l++){var o=a[l];e&&void 0!==n[o]||(n[o]=s[o])}return n}},x=function(t){if(!_.isObject(t))return{};if(v)return v(t);b.prototype=t;var e=new b;return b.prototype=null,e},O=function(t){return function(e){return null==e?void 0:e[t]}},M=Math.pow(2,53)-1,j=O("length"),k=function(t){var e=j(t);return"number"==typeof e&&e>=0&&e<=M};_.each=_.forEach=function(t,e,n){e=w(e,n);var r,i;if(k(t))for(r=0,i=t.length;r<i;r++)e(t[r],r,t);else{var s=_.keys(t);for(r=0,i=s.length;r<i;r++)e(t[s[r]],s[r],t)}return t},_.map=_.collect=function(t,e,n){e=A(e,n);for(var r=!k(t)&&_.keys(t),i=(r||t).length,s=Array(i),a=0;a<i;a++){var u=r?r[a]:a;s[a]=e(t[u],u,t)}return s},_.reduce=_.foldl=_.inject=t(1),_.reduceRight=_.foldr=t(-1),_.find=_.detect=function(t,e,n){var r;if(void 0!==(r=k(t)?_.findIndex(t,e,n):_.findKey(t,e,n))&&-1!==r)return t[r]},_.filter=_.select=function(t,e,n){var r=[];return e=A(e,n),_.each(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r},_.reject=function(t,e,n){return _.filter(t,_.negate(A(e)),n)},_.every=_.all=function(t,e,n){e=A(e,n);for(var r=!k(t)&&_.keys(t),i=(r||t).length,s=0;s<i;s++){var a=r?r[s]:s;if(!e(t[a],a,t))return!1}return!0},_.some=_.any=function(t,e,n){e=A(e,n);for(var r=!k(t)&&_.keys(t),i=(r||t).length,s=0;s<i;s++){var a=r?r[s]:s;if(e(t[a],a,t))return!0}return!1},_.contains=_.includes=_.include=function(t,e,n,r){return k(t)||(t=_.values(t)),("number"!=typeof n||r)&&(n=0),_.indexOf(t,e,n)>=0},_.invoke=function(t,e){var n=h.call(arguments,2),r=_.isFunction(e);return _.map(t,function(t){var i=r?e:t[e];return null==i?i:i.apply(t,n)})},_.pluck=function(t,e){return _.map(t,_.property(e))},_.where=function(t,e){return _.filter(t,_.matcher(e))},_.findWhere=function(t,e){return _.find(t,_.matcher(e))},_.max=function(t,e,n){var r,i,s=-1/0,a=-1/0;if(null==e&&null!=t)for(var u=0,l=(t=k(t)?t:_.values(t)).length;u<l;u++)(r=t[u])>s&&(s=r);else e=A(e,n),_.each(t,function(t,n,r){((i=e(t,n,r))>a||i===-1/0&&s===-1/0)&&(s=t,a=i)});return s},_.min=function(t,e,n){var r,i,s=1/0,a=1/0;if(null==e&&null!=t)for(var u=0,l=(t=k(t)?t:_.values(t)).length;u<l;u++)(r=t[u])<s&&(s=r);else e=A(e,n),_.each(t,function(t,n,r){((i=e(t,n,r))<a||i===1/0&&s===1/0)&&(s=t,a=i)});return s},_.shuffle=function(t){for(var e,n=k(t)?t:_.values(t),r=n.length,i=Array(r),s=0;s<r;s++)(e=_.random(0,s))!==s&&(i[s]=i[e]),i[e]=n[s];return i},_.sample=function(t,e,n){return null==e||n?(k(t)||(t=_.values(t)),t[_.random(t.length-1)]):_.shuffle(t).slice(0,Math.max(0,e))},_.sortBy=function(t,e,n){return e=A(e,n),_.pluck(_.map(t,function(t,n,r){return{value:t,index:n,criteria:e(t,n,r)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index}),"value")};var C=function(t){return function(e,n,r){var i={};return n=A(n,r),_.each(e,function(r,s){var a=n(r,s,e);t(i,r,a)}),i}};_.groupBy=C(function(t,e,n){_.has(t,n)?t[n].push(e):t[n]=[e]}),_.indexBy=C(function(t,e,n){t[n]=e}),_.countBy=C(function(t,e,n){_.has(t,n)?t[n]++:t[n]=1}),_.toArray=function(t){return t?_.isArray(t)?h.call(t):k(t)?_.map(t,_.identity):_.values(t):[]},_.size=function(t){return null==t?0:k(t)?t.length:_.keys(t).length},_.partition=function(t,e,n){e=A(e,n);var r=[],i=[];return _.each(t,function(t,n,s){(e(t,n,s)?r:i).push(t)}),[r,i]},_.first=_.head=_.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:_.initial(t,t.length-e)},_.initial=function(t,e,n){return h.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},_.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:_.rest(t,Math.max(0,t.length-e))},_.rest=_.tail=_.drop=function(t,e,n){return h.call(t,null==e||n?1:e)},_.compact=function(t){return _.filter(t,_.identity)};var E=function(t,e,n,r){for(var i=[],s=0,a=r||0,u=j(t);a<u;a++){var l=t[a];if(k(l)&&(_.isArray(l)||_.isArguments(l))){e||(l=E(l,e,n));var o=0,c=l.length;for(i.length+=c;o<c;)i[s++]=l[o++]}else n||(i[s++]=l)}return i};_.flatten=function(t,e){return E(t,e,!1)},_.without=function(t){return _.difference(t,h.call(arguments,1))},_.uniq=_.unique=function(t,e,n,r){_.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=A(n,r));for(var i=[],s=[],a=0,u=j(t);a<u;a++){var l=t[a],o=n?n(l,a,t):l;e?(a&&s===o||i.push(l),s=o):n?_.contains(s,o)||(s.push(o),i.push(l)):_.contains(i,l)||i.push(l)}return i},_.union=function(){return _.uniq(E(arguments,!0,!0))},_.intersection=function(t){for(var e=[],n=arguments.length,r=0,i=j(t);r<i;r++){var s=t[r];if(!_.contains(e,s)){for(var a=1;a<n&&_.contains(arguments[a],s);a++);a===n&&e.push(s)}}return e},_.difference=function(t){var e=E(arguments,!0,!0,1);return _.filter(t,function(t){return!_.contains(e,t)})},_.zip=function(){return _.unzip(arguments)},_.unzip=function(t){for(var e=t&&_.max(t,j).length||0,n=Array(e),r=0;r<e;r++)n[r]=_.pluck(t,r);return n},_.object=function(t,e){for(var n={},r=0,i=j(t);r<i;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},_.findIndex=r(1),_.findLastIndex=r(-1),_.sortedIndex=function(t,e,n,r){for(var i=(n=A(n,r,1))(e),s=0,a=j(t);s<a;){var u=Math.floor((s+a)/2);n(t[u])<i?s=u+1:a=u}return s},_.indexOf=i(1,_.findIndex,_.sortedIndex),_.lastIndexOf=i(-1,_.findLastIndex),_.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),s=0;s<r;s++,t+=n)i[s]=t;return i};var D=function(t,e,n,r,i){if(!(r instanceof e))return t.apply(n,i);var s=x(t.prototype),a=t.apply(s,i);return _.isObject(a)?a:s};_.bind=function(t,e){if(m&&t.bind===m)return m.apply(t,h.call(arguments,1));if(!_.isFunction(t))throw new TypeError("Bind must be called on a function");var n=h.call(arguments,2),r=function(){return D(t,r,e,this,n.concat(h.call(arguments)))};return r},_.partial=function(t){var e=h.call(arguments,1),n=function(){for(var r=0,i=e.length,s=Array(i),a=0;a<i;a++)s[a]=e[a]===_?arguments[r++]:e[a];for(;r<arguments.length;)s.push(arguments[r++]);return D(t,n,this,this,s)};return n},_.bindAll=function(t){var e,n,r=arguments.length;if(r<=1)throw new Error("bindAll must be passed function names");for(e=1;e<r;e++)t[n=arguments[e]]=_.bind(t[n],t);return t},_.memoize=function(t,e){var n=function(r){var i=n.cache,s=""+(e?e.apply(this,arguments):r);return _.has(i,s)||(i[s]=t.apply(this,arguments)),i[s]};return n.cache={},n},_.delay=function(t,e){var n=h.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},_.defer=_.partial(_.delay,_,1),_.throttle=function(t,e,n){var r,i,s,a=null,u=0;n||(n={});var l=function(){u=!1===n.leading?0:_.now(),a=null,s=t.apply(r,i),a||(r=i=null)};return function(){var o=_.now();u||!1!==n.leading||(u=o);var c=e-(o-u);return r=this,i=arguments,c<=0||c>e?(a&&(clearTimeout(a),a=null),u=o,s=t.apply(r,i),a||(r=i=null)):a||!1===n.trailing||(a=setTimeout(l,c)),s}},_.debounce=function(t,e,n){var r,i,s,a,u,l=function(){var o=_.now()-a;o<e&&o>=0?r=setTimeout(l,e-o):(r=null,n||(u=t.apply(s,i),r||(s=i=null)))};return function(){s=this,i=arguments,a=_.now();var o=n&&!r;return r||(r=setTimeout(l,e)),o&&(u=t.apply(s,i),s=i=null),u}},_.wrap=function(t,e){return _.partial(e,t)},_.negate=function(t){return function(){return!t.apply(this,arguments)}},_.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},_.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},_.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},_.once=_.partial(_.before,2);var I=!{toString:null}.propertyIsEnumerable("toString"),B=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];_.keys=function(t){if(!_.isObject(t))return[];if(g)return g(t);var e=[];for(var n in t)_.has(t,n)&&e.push(n);return I&&s(t,e),e},_.allKeys=function(t){if(!_.isObject(t))return[];var e=[];for(var n in t)e.push(n);return I&&s(t,e),e},_.values=function(t){for(var e=_.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t[e[i]];return r},_.mapObject=function(t,e,n){e=A(e,n);for(var r,i=_.keys(t),s=i.length,a={},u=0;u<s;u++)a[r=i[u]]=e(t[r],r,t);return a},_.pairs=function(t){for(var e=_.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=[e[i],t[e[i]]];return r},_.invert=function(t){for(var e={},n=_.keys(t),r=0,i=n.length;r<i;r++)e[t[n[r]]]=n[r];return e},_.functions=_.methods=function(t){var e=[];for(var n in t)_.isFunction(t[n])&&e.push(n);return e.sort()},_.extend=S(_.allKeys),_.extendOwn=_.assign=S(_.keys),_.findKey=function(t,e,n){e=A(e,n);for(var r,i=_.keys(t),s=0,a=i.length;s<a;s++)if(r=i[s],e(t[r],r,t))return r},_.pick=function(t,e,n){var r,i,s={},a=t;if(null==a)return s;_.isFunction(e)?(i=_.allKeys(a),r=w(e,n)):(i=E(arguments,!1,!1,1),r=function(t,e,n){return e in n},a=Object(a));for(var u=0,l=i.length;u<l;u++){var o=i[u],c=a[o];r(c,o,a)&&(s[o]=c)}return s},_.omit=function(t,e,n){if(_.isFunction(e))e=_.negate(e);else{var r=_.map(E(arguments,!1,!1,1),String);e=function(t,e){return!_.contains(r,e)}}return _.pick(t,e,n)},_.defaults=S(_.allKeys,!0),_.create=function(t,e){var n=x(t);return e&&_.extendOwn(n,e),n},_.clone=function(t){return _.isObject(t)?_.isArray(t)?t.slice():_.extend({},t):t},_.tap=function(t,e){return e(t),t},_.isMatch=function(t,e){var n=_.keys(e),r=n.length;if(null==t)return!r;for(var i=Object(t),s=0;s<r;s++){var a=n[s];if(e[a]!==i[a]||!(a in i))return!1}return!0};var F=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof _&&(t=t._wrapped),e instanceof _&&(e=e._wrapped);var i=p.call(t);if(i!==p.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}var s="[object Array]"===i;if(!s){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,u=e.constructor;if(a!==u&&!(_.isFunction(a)&&a instanceof a&&_.isFunction(u)&&u instanceof u)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],r=r||[];for(var l=n.length;l--;)if(n[l]===t)return r[l]===e;if(n.push(t),r.push(e),s){if((l=t.length)!==e.length)return!1;for(;l--;)if(!F(t[l],e[l],n,r))return!1}else{var o,c=_.keys(t);if(l=c.length,_.keys(e).length!==l)return!1;for(;l--;)if(o=c[l],!_.has(e,o)||!F(t[o],e[o],n,r))return!1}return n.pop(),r.pop(),!0};_.isEqual=function(t,e){return F(t,e)},_.isEmpty=function(t){return null==t||(k(t)&&(_.isArray(t)||_.isString(t)||_.isArguments(t))?0===t.length:0===_.keys(t).length)},_.isElement=function(t){return!(!t||1!==t.nodeType)},_.isArray=y||function(t){return"[object Array]"===p.call(t)},_.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){_["is"+t]=function(e){return p.call(e)==="[object "+t+"]"}}),_.isArguments(arguments)||(_.isArguments=function(t){return _.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(_.isFunction=function(t){return"function"==typeof t||!1}),_.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},_.isNaN=function(t){return _.isNumber(t)&&t!==+t},_.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===p.call(t)},_.isNull=function(t){return null===t},_.isUndefined=function(t){return void 0===t},_.has=function(t,e){return null!=t&&d.call(t,e)},_.noConflict=function(){return a._=u,this},_.identity=function(t){return t},_.constant=function(t){return function(){return t}},_.noop=function(){},_.property=O,_.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},_.matcher=_.matches=function(t){return t=_.extendOwn({},t),function(e){return _.isMatch(e,t)}},_.times=function(t,e,n){var r=Array(Math.max(0,t));e=w(e,n,1);for(var i=0;i<t;i++)r[i]=e(i);return r},_.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},_.now=Date.now||function(){return(new Date).getTime()};var N={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},R=_.invert(N),z=function(t){var e=function(e){return t[e]},n="(?:"+_.keys(t).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,e):t}};_.escape=z(N),_.unescape=z(R),_.result=function(t,e,n){var r=null==t?void 0:t[e];return void 0===r&&(r=n),_.isFunction(r)?r.call(t):r};var T=0;_.uniqueId=function(t){var e=++T+"";return t?t+e:e},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P=/(.)^/,W={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},$=/\\|'|\r|\n|\u2028|\u2029/g,q=function(t){return"\\"+W[t]};_.template=function(t,e,n){!e&&n&&(e=n),e=_.defaults({},e,_.templateSettings);var r=RegExp([(e.escape||P).source,(e.interpolate||P).source,(e.evaluate||P).source].join("|")+"|$","g"),i=0,s="__p+='";t.replace(r,function(e,n,r,a,u){return s+=t.slice(i,u).replace($,q),i=u+e.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":a&&(s+="';\n"+a+"\n__p+='"),e}),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var a=new Function(e.variable||"obj","_",s)}catch(t){throw t.source=s,t}var u=function(t){return a.call(this,t,_)},l=e.variable||"obj";return u.source="function("+l+"){\n"+s+"}",u},_.chain=function(t){var e=_(t);return e._chain=!0,e};var U=function(t,e){return t._chain?_(e).chain():e};_.mixin=function(t){_.each(_.functions(t),function(e){var n=_[e]=t[e];_.prototype[e]=function(){var t=[this._wrapped];return f.apply(t,arguments),U(this,n.apply(_,t))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=l[t];_.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],U(this,n)}}),_.each(["concat","join","slice"],function(t){var e=l[t];_.prototype[t]=function(){return U(this,e.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,_.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}).call(this)},{}],2:[function(t,e,n){!function(n,r){if(null!=("undefined"!=typeof define&&null!==define?define.amd:void 0))return define(["underscore"],r);if(null!=(void 0!==e&&null!==e?e.exports:void 0))return e.exports=r(t("underscore"));if(null!=n._)return n.rx=r(n._);throw"Dependencies are not met for reactive: _ not found"}(this,function(t){let e,n,r,i,s,a,u,l={},o=0,c=()=>o+=1,f=(t,e)=>new Set([...Array.from(t),...Array.from(e)]),h=(t,e)=>new Set(Array.from(t).filter(t=>e.has(t))),p=(t,e)=>new Set(Array.from(t).filter(t=>!e.has(t))),d=function(t,e){if(!(e in t))throw new Error(`object has no key ${e}`);let n=t[e];return delete t[e],n},y=function(t,e){let n=t.get(e);return t.delete(e),n},g=function(e){let n,r;null==e&&(e=[]);let i=null!=Object.create?Object.create(null):{};if(t.isArray(e))for([n,r]of Array.from(e))i[n]=r;else for(n in e)r=e[n],i[n]=r;return i},m=function(t){let e=0;for(let n of Array.from(t))e+=n;return e},v=l.DepMgr=class{constructor(){this.buffering=0,this.buffer=[],this.events=new Set}transaction(e){let n;this.buffering+=1;try{n=e()}finally{if(this.buffering-=1,0===this.buffering){let e=new Set(t.flatten(Array.from(this.events).map(({downstreamCells:t})=>Array.from(t)))),n=l.allDownstream(...Array.from(e||[]));n.forEach(t=>t._shield=!0);try{let t=this.buffer;this.buffer=[],this.events.clear(),t.map(function(...t){let[e,n]=Array.from(t[0]);return e.pub(n)}),n.forEach(t=>t.refresh())}finally{n.forEach(t=>t._shield=!1)}}}return n}};l._depMgr=r=new v;let b=l.Ev=class{constructor(t,e){this.observable=e,this.init=t,this.subs=g(),this.downstreamCells=new Set}sub(t){let e=c();return null!=this.init&&t(this.init()),this.subs[e]=t,e}pub(t){return r.buffering?(r.buffer.push([this,t]),r.events.add(this)):(()=>{let e=[];for(let n in this.subs){let r=this.subs[n];e.push(r(t))}return e})()}unsub(t){return d(this.subs,t)}scoped(t,e){let n=this.sub(t);try{return e()}finally{this.unsub(n)}}};l.skipFirst=function(t){let e=!0;return function(...n){return e?e=!1:t(...Array.from(n||[]))}},l.upstream=function(t){let e=Array.from(t.upstreamEvents).map(t=>t.observable);return Array.from(new Set(e))};var _=l._allDownstreamHelper=function(...e){if(e.length){let n=Array.from(new Set(t.flatten(e.map(t=>Array.from(t.onSet.downstreamCells))))),r=t.flatten([n,_(...Array.from(n||[]))]);return r}return[]};l.allDownstream=((...t)=>Array.from(new Set([...Array.from(t),...Array.from(_(...Array.from(t||[])))].reverse())).reverse());let w=l.Recorder=class{constructor(){this.stack=[],this.isMutating=!1,this.isIgnoring=!1,this.hidingMutationWarnings=!1,this.onMutationWarning=new b}record(e,n){this.stack.length>0&&!this.isMutating&&t(this.stack).last().addNestedBind(e),this.stack.push(e);let r=this.isMutating;this.isMutating=!1;let i=this.isIgnoring;this.isIgnoring=!1;try{return n()}finally{this.isIgnoring=i,this.isMutating=r,this.stack.pop()}}sub(e,n){if(null==n&&(n=(()=>!0)),this.stack.length>0&&!this.isIgnoring){let r=t(this.stack).last();return r.upstreamEvents.add(e),e.downstreamCells.add(r),l.autoSub(e,function(...t){if(n(...Array.from(t||[])))return r.refresh()})}}addCleanup(e){if(this.stack.length>0)return t(this.stack).last().addCleanup(e)}hideMutationWarnings(t){let e=this.hidingMutationWarnings;this.hidingMutationWarnings=!0;try{return t()}finally{this.hidingMutationWarnings=e}}fireMutationWarning(){return console.warn("Mutation to observable detected during a bind context"),this.onMutationWarning.pub(null)}mutating(t){this.stack.length>0&&!this.hidingMutationWarnings&&this.fireMutationWarning();let e=this.isMutating;this.isMutating=!0;try{return t()}finally{this.isMutating=e}}ignoring(t){let e=this.isIgnoring;this.isIgnoring=!0;try{return t()}finally{this.isIgnoring=e}}};l.types={cell:"cell",array:"array",map:"map",set:"set"},l._recorder=u=new w,l.hideMutationWarnings=(t=>u.hideMutationWarnings(t)),l.asyncBind=e=function(t,e){let n=new O(e,t);return n.refresh(),n},l.promiseBind=a=((t,n)=>e(t,function(){return this.record(n).done(t=>this.done(t))})),l.bind=n=(t=>e(null,function(){return this.done(this.record(t))})),l.lagBind=i=function(t,n,r){let i=null;return e(n,function(){return null!=i&&clearTimeout(i),i=setTimeout(()=>this.done(this.record(r)),t)})},l.postLagBind=s=function(t,n){let r=null;return e(t,function(){let{val:t,ms:e}=this.record(n);return null!=r&&clearTimeout(r),r=setTimeout(()=>this.done(t),e)})},l.snap=(t=>u.ignoring(t)),l.onDispose=(t=>u.addCleanup(t)),l.autoSub=function(t,e){let n=t.sub(e);return l.onDispose(()=>t.unsub(n)),n},l.subOnce=function(e,n){var r=l.autoSub(e,l.skipFirst(function(...i){return t.defer(()=>n(...Array.from(i||[]))),e.unsub(r)}));return r};let A=function(){let t=l.ObsBase=class{static initClass(){this.prototype.to={cell:()=>l.cell.from(this),array:()=>l.array.from(this),map:()=>l.map.from(this),set:()=>l.set.from(this)}}constructor(){this.events=[]}flatten(){return l.flatten(this)}subAll(t){return null==t&&(t=(()=>!0)),this.events.forEach(e=>u.sub(e,t))}raw(){return this._base}_mkEv(t){let e=new b(t,this);return this.events.push(e),e}};return t.initClass(),t}(),S=l.ObsCell=class extends A{constructor(t){super(),this._base=null!=t?t:null,this.onSet=this._mkEv(()=>[null,this._base]),this._shield=!1;let e=()=>this.onSet.downstreamCells;this.refreshAll=(()=>{if(this.onSet.downstreamCells.size&&!this._shield){this._shield=!0;let t=l.allDownstream(...Array.from(Array.from(e())||[]));t.forEach(t=>t._shield=!0);try{return t.forEach(t=>t.refresh())}finally{t.forEach(t=>t._shield=!1),this._shield=!1}}}),this.refreshSub=l.autoSub(this.onSet,this.refreshAll)}all(){return this.subAll(()=>!this._shield),this._base}get(){return this.all()}readonly(){return new O(()=>this.all())}},x=l.SrcCell=class extends S{set(t){return u.mutating(()=>{if(this._base!==t){let e=this._base;return this._base=t,this.onSet.pub([e,t]),e}})}};var O=l.DepCell=class extends S{constructor(t,e){super(null!=e?e:null),this.body=null!=t?t:null,this.refreshing=!1,this.nestedBinds=[],this.cleanups=[],this.upstreamEvents=new Set}refresh(){if(!this.refreshing){let e=this._base,n=t=>(this._base=t,this.onSet.pub([e,this._base])),r=!1,i=null,s=!1;var t={record:e=>{if(!this.refreshing){let a;if(this.disconnect(),r)throw new Error("this refresh has already recorded its dependencies");this.refreshing=!0,r=!0;try{a=u.record(this,()=>e.call(t))}finally{this.refreshing=!1}return s&&n(i),a}},done:t=>{if(e!==t)return this.refreshing?(s=!0,i=t):n(t)}};return this.body.call(t)}}disconnect(){for(let t of Array.from(this.cleanups))t();for(let t of Array.from(this.nestedBinds))t.disconnect();return this.nestedBinds=[],this.cleanups=[],this.upstreamEvents.forEach(t=>t.downstreamCells.delete(this)),this.upstreamEvents.clear()}addNestedBind(t){return this.nestedBinds.push(t)}addCleanup(t){return this.cleanups.push(t)}};let M=l.ObsArray=class extends A{constructor(t,e){null==t&&(t=[]),null==e&&(e=l.basicDiff()),super(),this._cells=t,this.diff=e,this.onChange=this._mkEv(()=>[0,[],this._cells.map(t=>t.raw())]),this.onChangeCells=this._mkEv(()=>[0,[],this._cells]),this._indexed=null}all(){return u.sub(this.onChange),this._cells.map(t=>t.get())}raw(){return this._cells.map(t=>t.raw())}readonly(){return new E(()=>this.all())}rawCells(){return this._cells}at(t){return u.sub(this.onChange,function(...e){let[n,r,i]=Array.from(e[0]);return n<=t&&r.length!==i.length||r.length===i.length&&t<=n+r.length}),null!=this._cells[t]?this._cells[t].get():void 0}length(){return u.sub(this.onChangeCells,function(...t){let[e,n,r]=Array.from(t[0]);return n.length!==r.length}),this._cells.length}size(){return this.length()}map(t){let e=new k;return l.autoSub(this.onChangeCells,(...r)=>{let[i,s,a]=Array.from(r[0]);for(var u of Array.from(e._cells.slice(i,i+s.length)))u.disconnect();let l=a.map(e=>u=n(()=>t(e.get())));return e.realSpliceCells(i,s.length,l)}),e}transform(t,e){return new E(()=>t(this.all()),e)}filter(t){return this.transform(e=>e.filter(t))}slice(t,e){return this.transform(n=>n.slice(t,e))}reduce(t,e){return this.all().reduce(t,null!=e?e:this.at(0))}reduceRight(t,e){return this.all().reduceRight(t,null!=e?e:this.at(0))}every(t){return this.all().every(t)}some(t){return this.all().some(t)}indexOf(t,e){return null==e&&(e=0),this.all().indexOf(t,e)}lastIndexOf(t,e){return null==e&&(e=this.length()-1),this.all().lastIndexOf(t,e)}join(t){return null==t&&(t=","),this.all().join(t)}first(){return this.at(0)}last(){return this.at(this.length()-1)}indexed(){return null==this._indexed&&(this._indexed=new C,l.autoSub(this.onChangeCells,(...t)=>{let[e,n,r]=Array.from(t[0]);return this._indexed.realSpliceCells(e,n.length,r)})),this._indexed}concat(...t){return l.concat(this,...Array.from(t))}realSpliceCells(t,e,n){let r=this._cells.splice.apply(this._cells,[t,e].concat(n)),i=l.snap(()=>Array.from(r).map(t=>t.get())),s=l.snap(()=>Array.from(n).map(t=>t.get()));return l.transaction(()=>(this.onChangeCells.pub([t,r,n]),this.onChange.pub([t,i,s])))}realSplice(t,e,n){return this.realSpliceCells(t,e,n.map(l.cell))}_update(t,e){let n;null==e&&({diff:e}=this);let r=l.snap(()=>Array.from(this._cells).map(t=>t.get())),i=[0,r.length,t],s=null!=e&&null!=(n=$(r.length,t,e(r,t)))?n:[i];return(()=>{let t=[];for(let e of Array.from(s)){let[n,r,i]=Array.from(e);t.push(this.realSplice(n,r,i))}return t})()}},j=l.SrcArray=class extends M{spliceArray(t,e,n){return u.mutating(()=>this.realSplice(t,e,n))}splice(t,e,...n){return this.spliceArray(t,e,n)}insert(t,e){return this.splice(e,0,t)}remove(e){let n=t(this.raw()).indexOf(e);if(n>=0)return this.removeAt(n)}removeAll(e){return l.transaction(()=>{let n=t(l.snap(()=>this.all())).indexOf(e);return(()=>{let r=[];for(;n>=0;)this.removeAt(n),r.push(n=t(l.snap(()=>this.all())).indexOf(e));return r})()})}removeAt(t){let e=l.snap(()=>this.at(t));return this.splice(t,1),e}push(t){return this.splice(l.snap(()=>this.length()),0,t)}pop(){return this.removeAt(l.snap(()=>this.length()-1))}put(t,e){return this.splice(t,1,e)}replace(t){return this.spliceArray(0,l.snap(()=>this.length()),t)}unshift(t){return this.insert(t,0)}shift(){return this.removeAt(0)}update(t){return u.mutating(()=>this._update(t))}move(t,e){return l.transaction(()=>{if(t===e)return;let n=l.snap(()=>this.length());if(t<0||t>n-1)throw`Source ${t} is outside of bounds of array of length ${n}`;if(e<0||e>n)throw`Destination ${e} is outside of bounds of array of length ${n}`;let r=l.snap(()=>this.all()[t]);t>e?(this.removeAt(t),this.insert(r,e)):(this.insert(r,e),this.removeAt(t))})}swap(t,e){return l.transaction(()=>{let n=l.snap(()=>this.length());if(t<0||t>n-1)throw`i1 ${t} is outside of bounds of array of length ${n}`;if(e<0||e>n-1)throw`i2 ${e} is outside of bounds of array of length ${n}`;let r=Math.min(t,e),i=Math.max(t,e);return this.move(r,i),this.move(i,r)})}reverse(){return this.update(l.snap(()=>this.all().reverse())),l.snap(()=>this.all())}};var k=l.MappedDepArray=class extends M{constructor(){super()}},C=l.IndexedDepArray=class extends M{constructor(e,n){null==e&&(e=[]),super(e,n),this.is=Array.from(this._cells).map((t,e)=>l.cell(e)),this.onChangeCells=this._mkEv(()=>[0,[],t.zip(this._cells,this.is)]),this.onChange=this._mkEv(()=>[0,[],t.zip(this.is,l.snap(()=>this.all()))])}map(t){let e=new k;return l.autoSub(this.onChangeCells,(...r)=>{let[i,s,a]=Array.from(r[0]);for(var u of Array.from(e._cells.slice(i,i+s.length)))u.disconnect();let l=(()=>{let e=[];for(var[r,i]of Array.from(a))e.push(u=n(()=>t(r.get(),i)));return e})();return e.realSpliceCells(i,s.length,l)}),e}realSpliceCells(e,n,r){let i,s=this._cells.splice.apply(this._cells,[e,n].concat(r)),a=l.snap(()=>Array.from(s).map(t=>t.get())),u=this.is.slice(e+n);for(let t=0;t<u.length;t++)(i=u[t]).set(e+r.length+t);let o=(()=>{let t,n,s=[];for(i=0,t=0<=(n=r.length);t?i<n:i>n;t?i++:i--)s.push(l.cell(e+i));return s})();this.is.splice(e,n,...Array.from(o));let c=l.snap(()=>Array.from(r).map(t=>t.get()));return l.transaction(()=>(this.onChangeCells.pub([e,s,t.zip(r,o)]),this.onChange.pub([e,a,t.zip(c,o)])))}};l.IndexedMappedDepArray=class extends C{};var E=l.DepArray=class extends M{constructor(t,e){super([],e),this.f=t,l.autoSub(n(()=>Array.from(this.f())).onSet,(...t)=>{let[e,n]=Array.from(t[0]);return this._update(n)})}};l.IndexedArray=class extends E{constructor(t){super(),this._cells=t}map(t){let e=new k;return l.autoSub(this._cells.onChange,function(...n){let[r,i,s]=Array.from(n[0]);return e.realSplice(r,i.length,s.map(t))}),e}};l.concat=function(...t){let e,n=new k,r=t.map(t=>l.cast(t,"array")),i=(()=>{let n=[];for(e of Array.from(t))n.push(0);return n})();return r.forEach((t,e)=>l.autoSub(t.onChange,function(...t){let[r,s,a]=Array.from(t[0]),u=m(i.slice(0,e));return i[e]+=a.length-s.length,n.realSplice(u+r,s.length,a)})),n};let D=function(e){return e instanceof Map?e:t.isArray(e)?new Map(e):new Map(t.pairs(e))},I=l.ObsMap=class extends A{constructor(t){null==t&&(t=new Map),super(),this._base=D(t),this.onAdd=this._mkEv(()=>new Map(this._base)),this.onRemove=this._mkEv(()=>new Map),this.onChange=this._mkEv(()=>new Map)}get(t){return this.subAll(e=>e.has(t)),this._base.get(t)}has(t){return u.sub(this.onAdd,e=>e.has(t)),u.sub(this.onRemove,e=>e.has(t)),this._base.has(t)}all(){return this.subAll(),new Map(this._base)}readonly(){return new F(()=>this.all())}size(){return u.sub(this.onRemove),u.sub(this.onAdd),this._base.size}realPut(t,e){if(this._base.has(t)){let n=this._base.get(t);return n!==e&&(this._base.set(t,e),this.onChange.pub(new Map([[t,[n,e]]]))),n}return this._base.set(t,e),void this.onAdd.pub(new Map([[t,e]]))}realRemove(t){let e=y(this._base,t);return this.onRemove.pub(new Map([[t,e]])),e}_update(e){let n,r=D(e),i=new Map(this._base),s=(()=>t.chain(Array.from(this._base.keys())).difference(Array.from(r.keys())).map(t=>[t,y(this._base,t)]).value())(),a=(()=>t.chain(Array.from(r.keys())).difference(Array.from(this._base.keys())).map(t=>(n=r.get(t),this._base.set(t,n),[t,n])).value())(),u=(()=>{let e;return t.chain(Array.from(r)).filter((...t)=>([e,n]=Array.from(t[0]),this._base.has(e)&&this._base.get(e)!==n)).map((...t)=>{[e,n]=Array.from(t[0]);let r=this._base.get(e);return this._base.set(e,n),[e,[r,n]]}).value()})();return l.transaction(()=>{if(s.length&&this.onRemove.pub(new Map(s)),a.length&&this.onAdd.pub(new Map(a)),u.length)return this.onChange.pub(new Map(u))}),i}},B=l.SrcMap=class extends I{put(t,e){return u.mutating(()=>this.realPut(t,e))}set(t,e){return this.put(t,e)}delete(t){return u.mutating(()=>{let e=void 0;return this._base.has(t)&&(e=this.realRemove(t),this.onRemove.pub(new Map([[t,e]]))),e})}remove(t){return this.delete(t)}clear(){return u.mutating(()=>{let t=new Map(this._base);return this._base.clear(),t.size&&this.onRemove.pub(t),t})}update(t){return u.mutating(()=>this._update(t))}};var F=l.DepMap=class extends I{constructor(t){super(),this.f=t;let e=n(this.f);l.autoSub(e.onSet,(...t)=>{let[e,n]=Array.from(t[0]);return this._update(n)})}};let N=function(t){return t instanceof Set?t:new Set(t)},R=function(t){return t instanceof Set||t instanceof z&&(t=t.all()),t instanceof M&&(t=t.all()),t instanceof S&&(t=t.get()),new Set(t)};var z=l.ObsSet=class extends A{constructor(t){null==t&&(t=new Set),super(),this._base=N(t),this.onChange=this._mkEv(()=>[this._base,new Set])}has(t){return this.subAll(function(...e){let[n,r]=Array.from(e[0]);return n.has(t)||r.has(t)}),this._base.has(t)}all(){return this.subAll(),new Set(this._base)}readonly(){return new P(()=>this.all())}values(){return this.all()}entries(){return this.all()}size(){return this.subAll(function(...t){let[e,n]=Array.from(t[0]);return e.size!==n.size}),this._base.size}union(t){return new P(()=>f(this.all(),R(t)))}intersection(t){return new P(()=>h(this.all(),R(t)))}difference(t){return new P(()=>p(this.all(),R(t)))}symmetricDifference(t){return new P(()=>{let e=this.all();return t=R(t),new Set(Array.from(f(e,t)).filter(n=>!e.has(n)||!t.has(n)))})}_update(t){return l.transaction(()=>{let e=new Set(this._base),n=N(t),r=new Set,i=new Set;return e.forEach(function(t){if(!n.has(t))return i.add(t)}),n.forEach(function(t){if(!e.has(t))return r.add(t)}),e.forEach(t=>this._base.delete(t)),n.forEach(t=>this._base.add(t)),this.onChange.pub([r,i]),e})}};let T=l.SrcSet=class extends z{add(t){return u.mutating(()=>(this._base.has(t)||(this._base.add(t),this.onChange.pub([new Set([t]),new Set])),t))}put(t){return this.add(t)}delete(t){return u.mutating(()=>(this._base.has(t)&&(this._base.delete(t),this.onChange.pub([new Set,new Set([t])])),t))}remove(t){return this.delete(t)}clear(){return u.mutating(()=>{let t=new Set(this._base);return this._base.size&&(this._base.clear(),this.onChange.pub([new Set,t])),t})}update(t){return u.mutating(()=>this._update(t))}};var P=l.DepSet=class extends z{constructor(t){super(),this.f=t;let e=n(this.f);l.autoSub(e.onSet,(...t)=>{let[e,n]=Array.from(t[0]);return this._update(n)})}};l.cellToSet=(t=>new l.DepSet(function(){return t.get()})),l.liftSpec=(e=>t.object((()=>{let n=[];for(let i of Array.from(Object.getOwnPropertyNames(e))){var r=e[i];if(null!=r&&[l.ObsMap,l.ObsCell,l.ObsArray,l.ObsSet].some(t=>r instanceof t))continue;let s=t.isFunction(r)?null:t.isArray(r)?"array":r instanceof Set?"set":r instanceof Map?"map":"cell";n.push([i,{type:s,val:r}])}return n})())),l.lift=function(e,n){return null==n&&(n=l.liftSpec(e)),t.mapObject(n,function({type:t},n){return!(e[n]instanceof A)&&t in l.types?l[t](e[n]):e[n]})},l.unlift=(e=>t.mapObject(e,function(t){return t instanceof l.ObsBase?t.all():t})),l.reactify=function(e,n){let r;if(t.isArray(e)){let n=l.array(t.clone(e));return Object.defineProperties(e,t.object(Object.getOwnPropertyNames(j.prototype).concat(Object.getOwnPropertyNames(M.prototype)).concat(Object.getOwnPropertyNames(A.prototype)).filter(t=>"length"!==t).map(t=>{let i=e[t];return r={configurable:!0,enumerable:!1,value:function(...r){let s;return null!=i&&(s=i.call(e,...r)),n[t].call(n,...r),s},writable:!0},[t,r]}))),e}return Object.defineProperties(e,t.object((()=>{let t=[];for(let e in n)r=n[e],t.push(function(t,e){let n=null;switch(e.type){case"cell":let t=l.cell(null!=e.val?e.val:null);n={configurable:!0,enumerable:!0,get(){return t.get()},set(e){return t.set(e)}};break;case"array":let r=l.reactify(null!=e.val?e.val:[]);n={configurable:!0,enumerable:!0,get(){return r.all(),r},set(t){return r.splice(0,r.length,...Array.from(t)),r}};break;default:throw new Error(`Unknown observable type: ${type}`)}return[t,n]}(e,r));return t})()))},l.autoReactify=(e=>l.reactify(e,t.object((()=>{let n=[];for(let r of Array.from(Object.getOwnPropertyNames(e))){let i=e[r];if(i instanceof A)continue;let s=t.isFunction(i)?null:t.isArray(i)?"array":"cell";n.push([r,{type:s,val:i}])}return n})()))),l.cell=(t=>new x(t)),l.cell.from=function(t){return t instanceof S?t:n(t instanceof A?()=>t.all():()=>t)},l.array=((t,e)=>new j((null!=t?t:[]).map(l.cell),e)),l.array.from=function(e,n){let r;if(e instanceof l.ObsArray)return e;if(t.isArray(e))r=(()=>e);else{if(!(e instanceof A))throw new Error(`Cannot cast ${e.constructor.name} to array!`);r=(()=>e.all())}return new E(r,n)},l.map=(t=>new B(t)),l.map.from=function(t){return t instanceof l.ObsMap?t:new F(t instanceof A?function(){return t.get()}:function(){return t})},l.set=(t=>new T(t)),l.set.from=function(t){return t instanceof l.ObsSet?t:new P(t instanceof l.ObsBase?function(){return t.all()}:function(){return t})},l.cast=function(e,n){if(null==n&&(n="cell"),[S,M,I,z].includes(n)){let t=null;switch(n){case S:t="cell";break;case M:t="array";break;case I:t="map";break;case z:t="set"}n=t}if(t.isString(n))return n in l.types?l[n].from(e):e;{let r=e,i=n,s=t.mapObject(r,function(t,e){return i[e]?l.cast(t,i[e]):t});return s}},l.flatten=(e=>new E(function(){return t.chain(W([e])).flatten().filter(t=>null!=t).value()}));var W=function(e){return e instanceof M?W(e.all()):e instanceof z?W(Array.from(e.values())):e instanceof S?W(e.get()):e instanceof Set?W(Array.from(e)):t.isArray(e)?e.map(t=>W(t)):e};l.cellToArray=((t,e)=>new E(function(){return t.get()},e)),l.cellToMap=(t=>new l.DepMap(function(){return t.get()})),l.cellToSet=(t=>new l.DepSet(function(){return t.get()})),l.basicDiff=function(t){return null==t&&(t=l.smartUidify),function(e,n){let r,i=g((()=>{let n=[];for(let i=0;i<e.length;i++)r=e[i],n.push([t(r),i]);return n})());return(()=>{let e=[];for(r of Array.from(n)){var s;e.push(null!=(s=i[t(r)])?s:-1)}return e})()}},l.uidify=(t=>null!=t.__rxUid?t.__rxUid:Object.defineProperty(t,"__rxUid",{enumerable:!1,value:c()}).__rxUid),l.smartUidify=function(e){return t.isObject(e)?l.uidify(e):JSON.stringify(e)};var $=function(e,n,r){let i;if(!n.length)return null;let s=(()=>{let t=[];for(i of Array.from(r))i>=0&&t.push(i);return t})();if(t.some((()=>{let t,e,n=[];for(i=0,t=0<=(e=s.length-1);t?i<e:i>e;t?i++:i--)n.push(s[i+1]-s[i]<=0);return n})()))return null;let a=[],u=-1;for(i=0;i<r.length;){for(;i<r.length&&r[i]===u+1;)u+=1,i+=1;let t={index:i,count:0,additions:[]};for(;i<r.length&&-1===r[i];)t.additions.push(n[i]),i+=1;let s=i===r.length?e:r[i];t.count=s-(u+1),(t.count>0||t.additions.length>0)&&a.push([t.index,t.count,t.additions]),u=s,i+=1}return a};return l.transaction=(t=>r.transaction(t)),l})},{underscore:1}]},{},[2]);